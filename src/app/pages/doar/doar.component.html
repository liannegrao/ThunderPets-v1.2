<!-- ===== CABE√áALHO DA PAGINA DOAR ===== -->
<header class="doar-page-header">
  <div class="container">
    <div class="header-content">
      <h1 class="page-title">Doa√ß√£o de Animal Terap√™utico</h1>
      <button class="btn-home" (click)="voltarAoInicio()">
        üè† Voltar ao In√≠cio
      </button>
    </div>
  </div>
</header>

<!-- ===== PROGRESS INDICATOR ===== -->
<section class="progress-section">
  <div class="container">
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" style="width: 100%"></div>
      </div>
      <div class="progress-steps">
        <div class="step active completed">
          <div class="step-number">1</div>
          <div class="step-label">Solicitar Doa√ß√£o Terap√™utica</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ===== FORM CONTEUDO ===== -->
<main class="main-content">
  <div class="container">
    <div class="form-card">

      <!-- ===== SE√á√ÉO PRINCIPAL ===== -->
      <div class="form-step">
        <form [formGroup]="doarForm" class="step-form" *ngIf="doarForm">

          <!-- ===== MOTIVA√á√ÉO EMOCIONAL ===== -->
          <div class="form-section">
            <h3>üíù Motiva√ß√µes Emocionais</h3>
            <p>Conte-nos quais necessidades emocionais gostaria de suprir com o pet (selecione todas que se aplicam)</p>

            <div class="motivacao-grid">
              <div class="motivacao-item"
                   [class.selected]="isMotivacaoSelected('depressao')"
                   (click)="toggleMotivacao('depressao')">
                <div class="motivacao-icon">üíô</div>
                <div class="motivacao-label">Depress√£o</div>
              </div>

              <div class="motivacao-item"
                   [class.selected]="isMotivacaoSelected('ansiedade')"
                   (click)="toggleMotivacao('ansiedade')">
                <div class="motivacao-icon">üß†</div>
                <div class="motivacao-label">Ansiedade</div>
              </div>

              <div class="motivacao-item"
                   [class.selected]="isMotivacaoSelected('solidao')"
                   (click)="toggleMotivacao('solidao')">
                <div class="motivacao-icon">üåô</div>
                <div class="motivacao-label">Solid√£o</div>
              </div>

              <div class="motivacao-item"
                   [class.selected]="isMotivacaoSelected('mudanca')"
                   (click)="toggleMotivacao('mudanca')">
                <div class="motivacao-icon">üîÑ</div>
                <div class="motivacao-label">Mudan√ßas de Vida</div>
              </div>

              <div class="motivacao-item"
                   [class.selected]="isMotivacaoSelected('terapia')"
                   (click)="toggleMotivacao('terapia')">
                <div class="motivacao-icon">üí≠</div>
                <div class="motivacao-label">Suporte Terap√™utico</div>
              </div>
            </div>

            <div formGroupName="motivacao" class="form-row">
              <div class="form-group full-width">
                <label for="documentoSuporte">Documento de suporte emocional (opcional)</label>
                <textarea
                  id="documentoSuporte"
                  formControlName="documentoSuporte"
                  placeholder="Caso tenha acompanhamento psicol√≥gico, refer√™ncia m√©dica ou outros documentos que comprovem suas necessidades emocionais, descreva brevemente."
                  rows="3"
                ></textarea>
                <small class="field-hint">Essa informa√ß√£o √© confidencial e ser√° usada apenas para valida√ß√£o pela equipe do ThunderPets.</small>
              </div>
            </div>
          </div>

          <!-- ===== PREFER√äNCIAS DO PET TERAP√äUTICO ===== -->
          <div class="form-section">
            <h3>üêæ Prefer√™ncias do Pet Terap√™utico</h3>
            <p>Que tipo de pet gostaria de receber para ajudar sua recupera√ß√£o emocional?</p>

            <div formGroupName="petPreferencias">
              <div class="form-row">
                <div class="form-group">
                  <label>Esp√©cie preferida *</label>
                  <div class="option-grid">
                    <div
                      *ngFor="let especie of especiesDisponiveis"
                      class="option-card option-card-large"
                      [class.selected]="isEspecieSelecionada(especie.value)"
                      (click)="togglePetEspecie(especie.value)"
                    >
                      <div class="option-icon">{{ especie.icon }}</div>
                      <div class="option-text">{{ especie.label }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label>Porte preferido</label>
                  <div class="option-grid">
                    <div
                      *ngFor="let porte of portesDisponiveis"
                      class="option-card"
                      [class.selected]="doarForm.get('petPreferencias.porte')?.value === porte.value"
                      (click)="doarForm.get('petPreferencias.porte')?.setValue(porte.value)"
                    >
                      <div class="option-icon">{{ porte.icon }}</div>
                      <div class="option-text">{{ porte.value === 'qualquer' ? 'Qualquer porte' : porte.label }}</div>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <label>N√≠vel de energia</label>
                  <div class="option-grid">
                    <div
                      *ngFor="let energia of energiaDisponivel"
                      class="option-card"
                      [class.selected]="doarForm.get('petPreferencias.energia')?.value === energia.value"
                      (click)="doarForm.get('petPreferencias.energia')?.setValue(energia.value)"
                    >
                      <div class="option-icon">{{ energia.icon }}</div>
                      <div class="option-text">{{ energia.label }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="checkbox-row">
                  <label class="checkbox-item">
                    <input type="checkbox" formControlName="idoso">
                    <span class="checkmark"></span>
                    <span>Estou aberto a adotar pets idosos (melhor compatibilidade emocional)</span>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- ===== INFORMA√á√ïES PESSOAIS ===== -->
          <div class="form-section">
            <h3>üë§ Informa√ß√µes Pessoais</h3>
            <p>Dados necess√°rios para o processo de doa√ß√£o terap√™utica</p>

            <div class="info-section">
              <h4>‚ÑπÔ∏è Por que precisamos dessas informa√ß√µes?</h4>
              <p>As ado√ß√µes terap√™uticas do ThunderPets s√£o realizadas ap√≥s avalia√ß√£o cuidadosa. As informa√ß√µes ajudam nossa equipe a entender melhor o perfil do futuro tutor e garantir que o pet v√° para um lar apropriado e terap√™utico.</p>
            </div>

            <div formGroupName="informacoesPessoais">
              <div class="form-row">
                <div class="form-group">
                  <label for="nome">Nome completo *</label>
                  <input
                    type="text"
                    id="nome"
                    formControlName="nome"
                    placeholder="Seu nome completo"
                    [class.error]="doarForm.get('informacoesPessoais.nome')?.invalid && doarForm.get('informacoesPessoais.nome')?.touched"
                  >
                  <div class="field-error" *ngIf="doarForm.get('informacoesPessoais.nome')?.invalid && doarForm.get('informacoesPessoais.nome')?.touched">
                    Nome √© obrigat√≥rio
                  </div>
                </div>

                <div class="form-group">
                  <label for="idade">Idade *</label>
                  <input
                    type="number"
                    id="idade"
                    formControlName="idade"
                    placeholder="Sua idade"
                    min="18"
                    max="120"
                    [class.error]="doarForm.get('informacoesPessoais.idade')?.invalid && doarForm.get('informacoesPessoais.idade')?.touched"
                  >
                  <div class="field-error" *ngIf="doarForm.get('informacoesPessoais.idade')?.invalid && doarForm.get('informacoesPessoais.idade')?.touched">
                    Idade √© obrigat√≥ria e deve ser maior que 18
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="localizacao">Localiza√ß√£o *</label>
                  <input
                    type="text"
                    id="localizacao"
                    formControlName="localizacao"
                    placeholder="Cidade - Estado (Ex: S√£o Paulo - SP)"
                    [class.error]="doarForm.get('informacoesPessoais.localizacao')?.invalid && doarForm.get('informacoesPessoais.localizacao')?.touched"
                  >
                  <div class="field-error" *ngIf="doarForm.get('informacoesPessoais.localizacao')?.invalid && doarForm.get('informacoesPessoais.localizacao')?.touched">
                    Localiza√ß√£o √© obrigat√≥ria
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group full-width">
                  <label for="situacaoAtual">Situa√ß√£o atual *</label>
                  <textarea
                    id="situacaoAtual"
                    formControlName="situacaoAtual"
                    placeholder="Conte-nos brevemente sobre sua situa√ß√£o atual e como um pet terap√™utico pode ajudar. Ex: Passando por tratamento de depress√£o, isolamento social devido a trabalho remoto, apoio emocional durante mudan√ßa de cidade, etc."
                    rows="3"
                    [class.error]="doarForm.get('informacoesPessoais.situacaoAtual')?.invalid && doarForm.get('informacoesPessoais.situacaoAtual')?.touched"
                  ></textarea>
                  <div class="field-error" *ngIf="doarForm.get('informacoesPessoais.situacaoAtual')?.invalid && doarForm.get('informacoesPessoais.situacaoAtual')?.touched">
                    Descri√ß√£o da situa√ß√£o atual √© obrigat√≥ria
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group full-width">
                  <label for="experienciaRelacionamento">Experi√™ncia anterior com animais</label>
                  <textarea
                    id="experienciaRelacionamento"
                    formControlName="experienciaRelacionamento"
                    placeholder="Conte sobre suas experi√™ncias anteriores com animais (n√£o obrigat√≥ria, mas ajuda muito nossa avalia√ß√£o)"
                    rows="2"
                  ></textarea>
                </div>
              </div>
            </div>
          </div>

          <!-- ===== CONTATO ===== -->
          <div class="form-section">
            <h3>üìû Informa√ß√µes de Contato</h3>

            <div formGroupName="contato">
              <div class="form-row">
                <div class="form-group">
                  <label for="email">E-mail *</label>
                  <input
                    type="email"
                    id="email"
                    formControlName="email"
                    placeholder="seu@email.com"
                    [class.error]="doarForm.get('contato.email')?.invalid && doarForm.get('contato.email')?.touched"
                  >
                  <div class="field-error" *ngIf="doarForm.get('contato.email')?.invalid && doarForm.get('contato.email')?.touched">
                    <div *ngIf="doarForm.get('contato.email')?.errors?.['required']">E-mail √© obrigat√≥rio</div>
                    <div *ngIf="doarForm.get('contato.email')?.errors?.['email']">Formato de e-mail inv√°lido</div>
                  </div>
                </div>

                <div class="form-group">
                  <label for="telefone">Telefone/WhatsApp *</label>
                  <input
                    type="text"
                    id="telefone"
                    formControlName="telefone"
                    placeholder="(11) 99999-9999"
                    [class.error]="doarForm.get('contato.telefone')?.invalid && doarForm.get('contato.telefone')?.touched"
                  >
                  <div class="field-error" *ngIf="doarForm.get('contato.telefone')?.invalid && doarForm.get('contato.telefone')?.touched">
                    <div *ngIf="doarForm.get('contato.telefone')?.errors?.['required']">Telefone √© obrigat√≥rio</div>
                    <div *ngIf="doarForm.get('contato.telefone')?.errors?.['pattern']">Formato: (11) 99999-9999 ou 11999999999</div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group full-width">
                  <label for="emergencia">Telefone de emerg√™ncia (opcional)</label>
                  <input
                    type="text"
                    id="emergencia"
                    formControlName="emergencia"
                    placeholder="Contato para situa√ß√µes de emerg√™ncia"
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- ===== COMPROMISSOS E ACORDO ===== -->
          <div class="form-section">
            <h3>ü§ù Compromissos do Tutor Terap√™utico</h3>
            <p>Para ado√ß√µes terap√™uticas, precisamos confirmar seu compromisso, pois este √© um v√≠nculo que impactar√° vidas (sua e do pet)</p>

            <div formGroupName="compromisso" class="compromissos-grid">
              <label class="checkbox-item">
                <input type="checkbox" formControlName="cuidados">
                <span class="checkmark"></span>
                <span class="compromisso-text">
                  <strong>Cuidado Respons√°vel:</strong> Comprometo-me a fornecer cuidados adequados, alimenta√ß√£o balanceada e ambiente seguro
                </span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" formControlName="tratamentoVeterinario">
                <span class="checkmark"></span>
                <span class="compromisso-text">
                  <strong>Cuidados Veterin√°rios:</strong> Estou preparado para arcar com despesas veterin√°rias (vacinas, medica√ß√µes, emerg√™ncias)
                </span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" formControlName="visitasMediador">
                <span class="checkmark"></span>
                <span class="compromisso-text">
                  <strong>Visitas de Acompanhamento:</strong> Aceito receber visitas peri√≥dicas do mediador do ThunderPets para avaliar o progresso terap√™utico
                </span>
              </label>

              <label class="checkbox-item">
                <input type="checkbox" formControlName="acompanhamento">
                <span class="checkmark"></span>
                <span class="compromisso-text">
                  <strong>Acompanhamento Terap√™utico:</strong> Comprometo-me a compartilhar feedback sobre como o pet est√° ajudando minha sa√∫de emocional
                </span>
              </label>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Urg√™ncia da necessidade</label>
                <div class="urgency-grid">
                  <div
                    *ngFor="let urgencia of urgenciaDisponivel"
                    class="urgency-card"
                    [class.selected]="doarForm.get('urgencia')?.value === urgencia.value"
                    [style.background-color]="getUrgenciaColor()"
                    (click)="doarForm.get('urgencia')?.setValue(urgencia.value)"
                  >
                    {{ urgencia.label }}
                  </div>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group full-width">
                <label for="observacoes">Observa√ß√µes finais</label>
                <textarea
                  id="observacoes"
                  formControlName="observacoes"
                  placeholder="H√° algo mais que gostaria de compartilhar? Prefer√™ncias espec√≠ficas, disponibilidade de tempo, restri√ß√µes ou qualquer informa√ß√£o relevante para o matching terap√™utico."
                  rows="3"
                ></textarea>
              </div>
            </div>
          </div>

        </form>
      </div>

      <!-- ===== NAVEGA√á√ÉO ===== -->
      <div class="step-navigation">
        <div class="nav-center">
          <button
            type="button"
            class="btn-primary large"
            (click)="onSubmit()"
          >
            üöÄ Enviar Solicita√ß√£o Terap√™utica
          </button>
        </div>
      </div>

    </div>
  </div>
</main>
